!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.gltfTransformUtil={})}(this,function(e){var t,r=function(){function e(e,t){this.json=e,this.resources=t}return e.prototype.resolveURI=function(e){return this.resources[e]},e.prototype.addImage=function(e,t,r){var n,s;switch(r){case"image/jpeg":n=e+".jpg",s="image/jpeg";break;case"image/png":n=e+".png",s="image/png";break;default:throw new Error('Unsupported image type, "'+r+'".')}return this.json.images.push({name:e,mimeType:s,uri:n}),this.resources[n]=t,this},e.prototype.removeImage=function(e){var t=this.json.textures.filter(function(t){return t.source===e});if(t.length)throw new Error("Image is in use by "+t.length+" textures and cannot be removed.");if(!this.resolveURI(this.json.images[e].uri))throw new Error("No such image, or image is embedded.");return this.json.images.splice(e,1),this.json.textures.forEach(function(t){t.source>e&&t.source--}),this},e.prototype.addBuffer=function(e,t){var r=e+".bin";return this.json.buffers.push({name:e,uri:r,byteLength:t.byteLength}),this.resources[r]=t,this},e.prototype.removeBuffer=function(e){var t=this.json.bufferViews.filter(function(t){return t.buffer===e});if(t.length)throw new Error("Buffer is in use by "+t.length+" bufferViews and cannot be removed.");var r=this.json.buffers[e];return this.json.buffers.splice(e,1),delete this.resources[r.uri],this},e.prototype.addAccessor=function(e,t,r){throw new Error("Not implemented.")},e.prototype.getAccessorArray=function(e){var t,r,n,s=this.json.accessors[e],o=this.json.bufferViews[s.bufferView],i=this.resources[this.json.buffers[o.buffer].uri];switch(s.type){case"VEC4":t=4;break;case"VEC3":t=3;break;case"VEC2":t=2;break;default:throw new Error("Accessor type "+s.type+" not implemented.")}switch(s.componentType){case 5126:return r=Float32Array.BYTES_PER_ELEMENT,n=i.slice(o.byteOffset+s.byteOffset,s.count*t*r),new Float32Array(n);case 5125:return r=Uint32Array.BYTES_PER_ELEMENT,n=i.slice(o.byteOffset+s.byteOffset,s.count*t*r),new Uint32Array(n);case 5123:return r=Uint16Array.BYTES_PER_ELEMENT,n=i.slice(o.byteOffset+s.byteOffset,s.count*t*r),new Uint16Array(n);default:throw new Error("Accessor componentType "+s.componentType+" not implemented.")}},e}();(t=e.LoggerVerbosity||(e.LoggerVerbosity={}))[t.NONE=3]="NONE",t[t.ERROR=2]="ERROR",t[t.WARNING=1]="WARNING",t[t.INFO=0]="INFO";var n=function(){function t(e,t){this.name=e,this.verbosity=t}return t.prototype.info=function(t){this.verbosity>=e.LoggerVerbosity.INFO&&console.log(this.name+": "+t)},t.prototype.warn=function(t){this.verbosity>=e.LoggerVerbosity.WARNING&&console.warn(this.name+": "+t)},t.prototype.error=function(t){this.verbosity>=e.LoggerVerbosity.ERROR&&console.error(this.name+": "+t)},t}(),s=function(){function e(){}return e.wrapGLTF=function(e,t){return new r(e,t)},e.wrapGLB=function(e){var t=new Uint32Array(e,0,3);if(1179937895!==t[0])throw new Error("Invalid glTF asset.");if(2!==t[1])throw new Error('Unsupported glTF binary version, "'+t[1]+'".');var n=new Uint32Array(e,12,2),s=new Uint32Array(e,20+n[0],2);if(1313821514!==n[1]||5130562!==s[1])throw new Error("Unexpected GLB layout.");var o=n[0],i=JSON.parse(this.decodeText(e.slice(20,20+o))),a=20+o,c=e.slice(a,a+s[0]);return i.buffers.find(function(e){return!e.uri}).uri="resources.bin",new r(i,{"resources.bin":c})},e.bundleGLTF=function(e){return{json:e.json,resources:e.resources}},e.bundleGLB=function(e){throw new Error("Not implemented.")},e.createBuffer=function(){return"undefined"==typeof Buffer?new ArrayBuffer(0):new Buffer([])},e.createBufferFromDataURI=function(e){if("undefined"==typeof Buffer){for(var t=atob(e.split(",")[1]),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r.buffer}return new Buffer(e.split(",")[1],"base64")},e.createLogger=function(e,t){return new n(e,t)},e.encodeText=function(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Buffer.from(e).buffer},e.decodeText=function(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Buffer.from(e).toString("utf8")},e.analyze=function(e){var t=this,r={meshes:(e.json.meshes||[]).length,textures:(e.json.textures||[]).length,materials:(e.json.materials||[]).length,animations:(e.json.animations||[]).length,primitives:0,dataUsage:{geometry:0,targets:0,animation:0,textures:0,json:0}};return(e.json.meshes||[]).forEach(function(n){r.primitives+=n.primitives.length,n.primitives.forEach(function(n){void 0!==n.indices&&(r.dataUsage.geometry+=t.getAccessorByteLength(e.json.accessors[n.indices])),Object.keys(n.attributes).forEach(function(s){r.dataUsage.geometry+=t.getAccessorByteLength(e.json.accessors[n.attributes[s]])}),(n.targets||[]).forEach(function(n){Object.keys(n).forEach(function(s){r.dataUsage.targets+=t.getAccessorByteLength(e.json.accessors[n[s]])})})})}),(e.json.animations||[]).forEach(function(n){n.samplers.forEach(function(n){var s=e.json.accessors[n.output];r.dataUsage.animation+=t.getAccessorByteLength(e.json.accessors[n.input]),r.dataUsage.animation+=t.getAccessorByteLength(s)})}),(e.json.images||[]).forEach(function(t){r.dataUsage.textures+=void 0!==t.uri?e.resolveURI(t.uri).byteLength:e.json.bufferViews[t.bufferView].byteLength}),r.dataUsage.json+=JSON.stringify(e.json).length,r},e.getAccessorByteLength=function(e){var t,r;switch(e.type){case"VEC4":t=4;break;case"VEC3":t=3;break;case"VEC2":t=2;break;case"MAT4":t=16;break;case"MAT3":t=9;break;case"MAT2":t=4;break;case"SCALAR":t=1;break;default:throw new Error("Unexpected accessor type, "+e.type+".")}switch(e.componentType){case 5125:case 5126:r=4;break;case 5123:case 5122:r=2;break;case 5121:case 5120:r=1}return t*r*e.count},e}();e.GLTFUtil=s,e.GLTFContainer=r,e.Logger=n});
//# sourceMappingURL=gltf-transform-util.umd.js.map
